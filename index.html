<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <title>シャトルバス時刻表ビューア</title>
    <style>
        body {
            font-family: system-ui, sans-serif;
            padding: 1.5rem;
            background: #f5f5f5;
        }

        h1 {
            text-align: center;
            margin-bottom: 1rem;
            font-size: 1.4rem;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: #fff;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
        }

        .controls {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        select,
        button {
            padding: 0.3rem 0.6rem;
            font-size: 0.9rem;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }

        th,
        td {
            border: 1px solid #ddd;
            padding: 0.3rem 0.4rem;
            text-align: center;
        }

        th {
            background: #eef3ff;
            position: sticky;
            top: 0;
        }

        .day-type-toggle {
            display: inline-flex;
            border: 1px solid #ddd;
            border-radius: 999px;
            overflow: hidden;
        }

        .day-type-toggle button {
            border: none;
            background: #f7f7f7;
            cursor: pointer;
        }

        .day-type-toggle button.active {
            background: #2563eb;
            color: white;
        }

        .table-wrapper {
            max-height: 480px;
            overflow: auto;
            border: 1px solid #eee;
            border-radius: 8px;
        }
    </style>
</head>

<body>

    <h1>シャトルバス時刻表</h1>

    <div class="container">
        <div class="controls">
            <div>
                路線：
                <select id="route-select"></select>
            </div>

            <div class="day-type-toggle">
                <button type="button" data-day="weekday" class="active">平日</button>
                <button type="button" data-day="weekend">土日祝</button>
            </div>
        </div>

        <div class="table-wrapper">
            <table id="timetable"></table>
        </div>
    </div>

    <script>
        // ★ ここにあなたの JSON ファイルのパスを指定する ★
        const JSON_URL = "timetable.json";
        // 例：あなたがアップしたファイルを使う場合
        // const JSON_URL = "/mnt/data/shuttle_turugi2.json";

        let data = null;
        let currentDay = "weekday";

        const routeSelect = document.getElementById("route-select");
        const timetableTable = document.getElementById("timetable");

        async function loadJSON() {
            const res = await fetch(JSON_URL);
            data = await res.json();
            initUI();
        }

        function initUI() {
            // 路線リストを生成
            data.routes.forEach(route => {
                const opt = document.createElement("option");
                opt.value = route.id;
                opt.textContent = route.name;
                routeSelect.appendChild(opt);
            });

            routeSelect.addEventListener("change", renderTable);

            document.querySelectorAll(".day-type-toggle button").forEach(btn => {
                btn.addEventListener("click", () => {
                    document.querySelectorAll(".day-type-toggle button").forEach(b => b.classList.remove("active"));
                    btn.classList.add("active");
                    currentDay = btn.dataset.day;
                    renderTable();
                });
            });

            routeSelect.value = data.routes[0].id;
            renderTable();
        }

        function renderTable() {
            const route = data.routes.find(r => r.id === routeSelect.value);
            const stops = route.stops;
            const trips = route.schedules[currentDay];

            timetableTable.innerHTML = "";

            // --- ヘッダー ---
            const thead = timetableTable.createTHead();
            const hRow = thead.insertRow();
            let th = document.createElement("th");
            th.textContent = "便";
            hRow.appendChild(th);

            stops.forEach(stop => {
                const th2 = document.createElement("th");
                th2.textContent = stop;
                hRow.appendChild(th2);
            });

            // --- 本体 ---
            const tbody = timetableTable.createTBody();
            trips.forEach((times, idx) => {
                const r = tbody.insertRow();
                let c = r.insertCell();
                c.textContent = `${idx + 1}便`;

                times.forEach(t => {
                    const tc = r.insertCell();
                    tc.textContent = t || "";
                });
            });
        }

        loadJSON();
    </script>

</body>

</html>